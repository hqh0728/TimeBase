Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='720_96', model='PatchTST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:1
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.batchnorm.BatchNorm1d'>.
MACs: 776079360.0
Params: 1505632.0
776.08M MACs
>>>>>>>start training : 720_96_PatchTST_custom_ftM_sl720_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.7532189
	speed: 0.0742s/iter; left time: 2503.2361s
	iters: 200, epoch: 1 | loss: 0.7433630
	speed: 0.0700s/iter; left time: 2354.0466s
	iters: 300, epoch: 1 | loss: 0.5337368
	speed: 0.0701s/iter; left time: 2350.6055s
	iters: 400, epoch: 1 | loss: 0.7799979
	speed: 0.0702s/iter; left time: 2347.3423s
	iters: 500, epoch: 1 | loss: 0.5254982
	speed: 0.0701s/iter; left time: 2336.9918s
	iters: 600, epoch: 1 | loss: 0.4289204
	speed: 0.0701s/iter; left time: 2330.1193s
	iters: 700, epoch: 1 | loss: 0.4939663
	speed: 0.0701s/iter; left time: 2322.3462s
	iters: 800, epoch: 1 | loss: 0.4036134
	speed: 0.0700s/iter; left time: 2312.2105s
	iters: 900, epoch: 1 | loss: 0.6047972
	speed: 0.0699s/iter; left time: 2304.1383s
	iters: 1000, epoch: 1 | loss: 0.6509252
	speed: 0.0700s/iter; left time: 2298.2048s
	iters: 1100, epoch: 1 | loss: 0.5363452
	speed: 0.0698s/iter; left time: 2286.8191s
Epoch: 1 cost time: 79.44126296043396
Epoch: 1, Steps: 1128 | Train Loss: 0.6411269 Vali Loss: 0.4560218 Test Loss: 0.1843886
Validation loss decreased (inf --> 0.456022).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3513827
	speed: 0.2444s/iter; left time: 7969.7461s
	iters: 200, epoch: 2 | loss: 0.3344701
	speed: 0.0700s/iter; left time: 2275.3883s
	iters: 300, epoch: 2 | loss: 0.5553885
	speed: 0.0700s/iter; left time: 2268.8342s
	iters: 400, epoch: 2 | loss: 0.4122611
	speed: 0.0702s/iter; left time: 2267.4601s
	iters: 500, epoch: 2 | loss: 0.4218283
	speed: 0.0703s/iter; left time: 2265.1947s
	iters: 600, epoch: 2 | loss: 0.4464604
	speed: 0.0703s/iter; left time: 2258.1123s
	iters: 700, epoch: 2 | loss: 0.4134151
	speed: 0.0701s/iter; left time: 2243.4741s
	iters: 800, epoch: 2 | loss: 0.3608984
	speed: 0.0700s/iter; left time: 2234.4590s
	iters: 900, epoch: 2 | loss: 0.4317083
	speed: 0.0700s/iter; left time: 2226.8850s
	iters: 1000, epoch: 2 | loss: 0.2788469
	speed: 0.0699s/iter; left time: 2217.6822s
	iters: 1100, epoch: 2 | loss: 0.2485773
	speed: 0.0699s/iter; left time: 2210.4990s
Epoch: 2 cost time: 79.38736844062805
Epoch: 2, Steps: 1128 | Train Loss: 0.4423356 Vali Loss: 0.3907836 Test Loss: 0.1547205
Validation loss decreased (0.456022 --> 0.390784).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2939255
	speed: 0.2454s/iter; left time: 7726.2972s
	iters: 200, epoch: 3 | loss: 0.2460093
	speed: 0.0701s/iter; left time: 2200.9718s
	iters: 300, epoch: 3 | loss: 0.4687592
	speed: 0.0700s/iter; left time: 2190.2853s
	iters: 400, epoch: 3 | loss: 0.4337143
	speed: 0.0700s/iter; left time: 2183.0001s
	iters: 500, epoch: 3 | loss: 0.4014584
	speed: 0.0699s/iter; left time: 2174.3192s
	iters: 600, epoch: 3 | loss: 0.9048676
	speed: 0.0700s/iter; left time: 2167.5403s
	iters: 700, epoch: 3 | loss: 0.2722793
	speed: 0.0700s/iter; left time: 2162.5771s
	iters: 800, epoch: 3 | loss: 0.3587495
	speed: 0.0700s/iter; left time: 2154.0000s
	iters: 900, epoch: 3 | loss: 0.3399397
	speed: 0.0699s/iter; left time: 2144.9075s
	iters: 1000, epoch: 3 | loss: 0.2729531
	speed: 0.0699s/iter; left time: 2137.6695s
	iters: 1100, epoch: 3 | loss: 0.3408405
	speed: 0.0707s/iter; left time: 2153.8026s
Epoch: 3 cost time: 79.38371586799622
Epoch: 3, Steps: 1128 | Train Loss: 0.4241575 Vali Loss: 0.3906087 Test Loss: 0.1505792
Validation loss decreased (0.390784 --> 0.390609).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2896077
	speed: 0.2467s/iter; left time: 7488.0400s
	iters: 200, epoch: 4 | loss: 0.4390998
	speed: 0.0702s/iter; left time: 2123.9625s
	iters: 300, epoch: 4 | loss: 0.2675681
	speed: 0.0701s/iter; left time: 2114.4940s
	iters: 400, epoch: 4 | loss: 0.2667081
	speed: 0.0701s/iter; left time: 2107.9843s
	iters: 500, epoch: 4 | loss: 0.2535836
	speed: 0.0702s/iter; left time: 2101.9355s
	iters: 600, epoch: 4 | loss: 0.3285021
	speed: 0.0701s/iter; left time: 2093.6116s
	iters: 700, epoch: 4 | loss: 0.4604647
	speed: 0.0700s/iter; left time: 2084.0385s
	iters: 800, epoch: 4 | loss: 0.3246494
	speed: 0.0702s/iter; left time: 2080.7990s
	iters: 900, epoch: 4 | loss: 0.3086324
	speed: 0.0702s/iter; left time: 2075.6945s
	iters: 1000, epoch: 4 | loss: 0.3794714
	speed: 0.0702s/iter; left time: 2067.0961s
	iters: 1100, epoch: 4 | loss: 0.2525162
	speed: 0.0702s/iter; left time: 2059.5230s
Epoch: 4 cost time: 79.48629593849182
Epoch: 4, Steps: 1128 | Train Loss: 0.4154115 Vali Loss: 0.4087863 Test Loss: 0.1633236
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2973309
	speed: 0.2467s/iter; left time: 7211.0096s
	iters: 200, epoch: 5 | loss: 0.3773327
	speed: 0.0701s/iter; left time: 2043.0401s
	iters: 300, epoch: 5 | loss: 0.3583216
	speed: 0.0702s/iter; left time: 2036.5256s
	iters: 400, epoch: 5 | loss: 0.3329554
	speed: 0.0702s/iter; left time: 2031.2527s
	iters: 500, epoch: 5 | loss: 0.2532145
	speed: 0.0702s/iter; left time: 2023.6999s
	iters: 600, epoch: 5 | loss: 0.4539045
	speed: 0.0702s/iter; left time: 2016.3929s
	iters: 700, epoch: 5 | loss: 0.3962631
	speed: 0.0701s/iter; left time: 2007.1599s
	iters: 800, epoch: 5 | loss: 1.1672682
	speed: 0.0702s/iter; left time: 2003.4708s
	iters: 900, epoch: 5 | loss: 0.2595848
	speed: 0.0701s/iter; left time: 1993.6130s
	iters: 1000, epoch: 5 | loss: 0.2210695
	speed: 0.0702s/iter; left time: 1987.2853s
	iters: 1100, epoch: 5 | loss: 1.4676636
	speed: 0.0702s/iter; left time: 1980.5289s
Epoch: 5 cost time: 79.52258276939392
Epoch: 5, Steps: 1128 | Train Loss: 0.4099604 Vali Loss: 0.3798459 Test Loss: 0.1483306
Validation loss decreased (0.390609 --> 0.379846).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3580775
	speed: 0.2474s/iter; left time: 6952.4010s
	iters: 200, epoch: 6 | loss: 0.2593670
	speed: 0.0701s/iter; left time: 1962.0988s
	iters: 300, epoch: 6 | loss: 0.3673045
	speed: 0.0700s/iter; left time: 1954.2103s
	iters: 400, epoch: 6 | loss: 0.2952142
	speed: 0.0700s/iter; left time: 1945.9983s
	iters: 500, epoch: 6 | loss: 0.2405344
	speed: 0.0700s/iter; left time: 1940.3641s
	iters: 600, epoch: 6 | loss: 1.1534804
	speed: 0.0702s/iter; left time: 1936.5391s
	iters: 700, epoch: 6 | loss: 1.0319401
	speed: 0.0702s/iter; left time: 1929.8405s
	iters: 800, epoch: 6 | loss: 0.2546074
	speed: 0.0702s/iter; left time: 1923.7444s
	iters: 900, epoch: 6 | loss: 1.2135502
	speed: 0.0703s/iter; left time: 1919.8011s
	iters: 1000, epoch: 6 | loss: 0.2968144
	speed: 0.0703s/iter; left time: 1912.2343s
	iters: 1100, epoch: 6 | loss: 0.3320042
	speed: 0.0703s/iter; left time: 1906.5043s
Epoch: 6 cost time: 79.5715057849884
Epoch: 6, Steps: 1128 | Train Loss: 0.4064787 Vali Loss: 0.3926938 Test Loss: 0.1514691
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2819920
	speed: 0.2471s/iter; left time: 6664.0832s
	iters: 200, epoch: 7 | loss: 0.2507336
	speed: 0.0702s/iter; left time: 1885.5723s
	iters: 300, epoch: 7 | loss: 0.2746963
	speed: 0.0701s/iter; left time: 1876.5486s
	iters: 400, epoch: 7 | loss: 0.2517535
	speed: 0.0701s/iter; left time: 1870.2048s
	iters: 500, epoch: 7 | loss: 0.2718251
	speed: 0.0702s/iter; left time: 1865.9533s
	iters: 600, epoch: 7 | loss: 0.3980664
	speed: 0.0702s/iter; left time: 1857.9106s
	iters: 700, epoch: 7 | loss: 0.9987403
	speed: 0.0701s/iter; left time: 1849.9182s
	iters: 800, epoch: 7 | loss: 0.3460747
	speed: 0.0702s/iter; left time: 1843.5933s
	iters: 900, epoch: 7 | loss: 0.2770232
	speed: 0.0702s/iter; left time: 1837.7876s
	iters: 1000, epoch: 7 | loss: 0.2878493
	speed: 0.0702s/iter; left time: 1830.8880s
	iters: 1100, epoch: 7 | loss: 0.2889294
	speed: 0.0702s/iter; left time: 1824.1170s
Epoch: 7 cost time: 79.53323173522949
Epoch: 7, Steps: 1128 | Train Loss: 0.4017306 Vali Loss: 0.3924629 Test Loss: 0.1505645
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3817827
	speed: 0.2474s/iter; left time: 6395.2538s
	iters: 200, epoch: 8 | loss: 0.1980508
	speed: 0.0701s/iter; left time: 1804.9755s
	iters: 300, epoch: 8 | loss: 0.3205177
	speed: 0.0701s/iter; left time: 1797.2477s
	iters: 400, epoch: 8 | loss: 0.4036530
	speed: 0.0701s/iter; left time: 1789.7929s
	iters: 500, epoch: 8 | loss: 0.2157186
	speed: 0.0701s/iter; left time: 1783.0905s
	iters: 600, epoch: 8 | loss: 0.5116008
	speed: 0.0701s/iter; left time: 1776.9726s
	iters: 700, epoch: 8 | loss: 0.4003828
	speed: 0.0701s/iter; left time: 1769.4313s
	iters: 800, epoch: 8 | loss: 0.2903138
	speed: 0.0703s/iter; left time: 1767.2677s
	iters: 900, epoch: 8 | loss: 0.2695318
	speed: 0.0704s/iter; left time: 1762.2316s
	iters: 1000, epoch: 8 | loss: 0.3230565
	speed: 0.0703s/iter; left time: 1753.9593s
	iters: 1100, epoch: 8 | loss: 0.2630259
	speed: 0.0702s/iter; left time: 1744.1623s
Epoch: 8 cost time: 79.53167748451233
Epoch: 8, Steps: 1128 | Train Loss: 0.3979436 Vali Loss: 0.3881595 Test Loss: 0.1478037
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2653229
	speed: 0.2467s/iter; left time: 6098.2650s
	iters: 200, epoch: 9 | loss: 0.4112275
	speed: 0.0702s/iter; left time: 1728.4432s
	iters: 300, epoch: 9 | loss: 0.2220179
	speed: 0.0701s/iter; left time: 1718.4720s
	iters: 400, epoch: 9 | loss: 0.2055071
	speed: 0.0701s/iter; left time: 1711.2882s
	iters: 500, epoch: 9 | loss: 0.3061020
	speed: 0.0700s/iter; left time: 1703.0472s
	iters: 600, epoch: 9 | loss: 0.3047652
	speed: 0.0700s/iter; left time: 1695.6371s
	iters: 700, epoch: 9 | loss: 0.5477037
	speed: 0.0701s/iter; left time: 1690.9518s
	iters: 800, epoch: 9 | loss: 0.3082866
	speed: 0.0702s/iter; left time: 1686.3823s
	iters: 900, epoch: 9 | loss: 0.2619069
	speed: 0.0704s/iter; left time: 1683.0463s
	iters: 1000, epoch: 9 | loss: 0.2661137
	speed: 0.0703s/iter; left time: 1675.5230s
	iters: 1100, epoch: 9 | loss: 0.2188724
	speed: 0.0701s/iter; left time: 1663.0221s
Epoch: 9 cost time: 79.527987241745
Epoch: 9, Steps: 1128 | Train Loss: 0.3956538 Vali Loss: 0.3807481 Test Loss: 0.1460535
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 1.1857197
	speed: 0.2465s/iter; left time: 5813.8707s
	iters: 200, epoch: 10 | loss: 0.2536094
	speed: 0.0700s/iter; left time: 1643.3852s
	iters: 300, epoch: 10 | loss: 0.2918434
	speed: 0.0701s/iter; left time: 1639.5455s
	iters: 400, epoch: 10 | loss: 1.0768604
	speed: 0.0700s/iter; left time: 1629.5983s
	iters: 500, epoch: 10 | loss: 0.4402984
	speed: 0.0700s/iter; left time: 1623.4584s
	iters: 600, epoch: 10 | loss: 0.2711151
	speed: 0.0702s/iter; left time: 1619.7291s
	iters: 700, epoch: 10 | loss: 0.3280425
	speed: 0.0701s/iter; left time: 1610.9256s
	iters: 800, epoch: 10 | loss: 0.1920302
	speed: 0.0699s/iter; left time: 1599.9311s
	iters: 900, epoch: 10 | loss: 0.4363843
	speed: 0.0707s/iter; left time: 1611.2241s
	iters: 1000, epoch: 10 | loss: 0.3139346
	speed: 0.0703s/iter; left time: 1594.3785s
	iters: 1100, epoch: 10 | loss: 0.3195300
	speed: 0.0711s/iter; left time: 1605.2709s
Epoch: 10 cost time: 79.54918193817139
Epoch: 10, Steps: 1128 | Train Loss: 0.3933545 Vali Loss: 0.3827919 Test Loss: 0.1455177
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : 720_96_PatchTST_custom_ftM_sl720_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.14853587746620178, mae:0.19939450919628143, rse:0.5078879594802856
